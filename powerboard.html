<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Powerboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
</head>
<body>
    <div class="container">
        <table class="table">
            <thead>
                <tr>
                    <th class="scope">Date and Time</th>
                    <th class="scope">First Average</th>
                    <th class="scope">Second Average</th>
                    <th class="scope">Predicted Output</th>
                    <th class="scope">Expected Result</th>
                </tr>
            </thead>
            <tbody id="list">

            </tbody>
        </table>
    </div>
  <script>
        const httpGetAsync = (url, callback) => {
            const xmlHttp = new XMLHttpRequest();
            xmlHttp.onreadystatechange = () => {
                if (xmlHttp.readyState == 4 && xmlHttp.status == 200) callback(xmlHttp.responseText)
            }
            xmlHttp.open('GET', url, true)
            xmlHttp.send(null)
        }
        httpGetAsync('https://cors.io/?https://nx5jg0ntc8.execute-api.ap-southeast-1.amazonaws.com/prod/getPowerboardML', (response) => {
            const data = JSON.parse(response)
            const tbody = document.querySelector('tbody#list')
            
            let items = data.Items
            items.sort((a,b) => {
                let c = new Date(a.DateTime)
                let d = new Date(b.DateTime)
                return c - d
            }).reverse()
            
            const appList = (items, l=[]) => {
                items.forEach((item) => {
                    if (l.indexOf(item.PredictedOutput) == -1){
                        l.push(item.PredictedOutput)
                    } 
                })
                return l
            }

            let counter = 1
            items.forEach((item) => {
                const tr = document.createElement('tr')
                tr.id = counter
                let td = document.createElement('td')
                let text = document.createTextNode(item.DateTime)
                td.appendChild(text)
                tr.appendChild(td)
                td = document.createElement('td')
                text = document.createTextNode(item.values.first_ave)
                td.appendChild(text)
                tr.appendChild(td)
                td = document.createElement('td')
                text = document.createTextNode(item.values.second_ave)
                td.appendChild(text)
                tr.appendChild(td)
                td = document.createElement('td')
                text = document.createTextNode(item.PredictedOutput)
                td.appendChild(text)
                tr.appendChild(td)
                tbody.appendChild(tr)

                counter += 1
            })
        })
    </script>
</body>
</html>